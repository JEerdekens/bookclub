{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Routes,Route,useLocation,Navigate}from\"react-router-dom\";import{auth}from\"../firebase\";import{setPersistence,browserLocalPersistence}from\"firebase/auth\";import Navbar from\"./Navbar\";import PublicLanding from\"../pages/PublicLanding\";import PrivateHome from\"../pages/PrivateHome\";import BookList from\"../pages/BookList\";import BookDetails from\"../pages/BookDetails\";import AddBook from\"../pages/AddBook\";import Profile from\"../pages/Profile\";import ChooseUsername from\"../pages/ChooseUsername\";import PrivateRoute from\"./PrivateRoute\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function AppWrapper(){const[user,setUser]=useState(null);const[authChecked,setAuthChecked]=useState(false);const location=useLocation();useEffect(()=>{let unsubscribe;setPersistence(auth,browserLocalPersistence).then(()=>{unsubscribe=auth.onAuthStateChanged(currentUser=>{if(currentUser&&currentUser.emailVerified){setUser(currentUser);}else{setUser(null);}setAuthChecked(true);});}).catch(error=>{console.error(\"Failed to set persistence:\",error);setAuthChecked(true);});return()=>{if(unsubscribe)unsubscribe();};},[]);const showNavbar=user&&location.pathname!==\"/\";if(!authChecked){return/*#__PURE__*/_jsx(\"div\",{className:\"text-center mt-5\",children:\"Loading...\"});}return/*#__PURE__*/_jsxs(_Fragment,{children:[showNavbar&&/*#__PURE__*/_jsx(Navbar,{user:user}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:user?/*#__PURE__*/_jsx(Navigate,{to:\"/home\",replace:true}):/*#__PURE__*/_jsx(PublicLanding,{})}),/*#__PURE__*/_jsx(Route,{path:\"/choose-username\",element:/*#__PURE__*/_jsx(ChooseUsername,{})}),/*#__PURE__*/_jsx(Route,{path:\"/home\",element:/*#__PURE__*/_jsx(PrivateRoute,{user:user,children:/*#__PURE__*/_jsx(PrivateHome,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/books\",element:/*#__PURE__*/_jsx(PrivateRoute,{user:user,children:/*#__PURE__*/_jsx(BookList,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/books/:id\",element:/*#__PURE__*/_jsx(PrivateRoute,{user:user,children:/*#__PURE__*/_jsx(BookDetails,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/add\",element:/*#__PURE__*/_jsx(PrivateRoute,{user:user,children:/*#__PURE__*/_jsx(AddBook,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:/*#__PURE__*/_jsx(PrivateRoute,{user:user,children:/*#__PURE__*/_jsx(Profile,{})})})]})]});}export default AppWrapper;","map":{"version":3,"names":["React","useState","useEffect","Routes","Route","useLocation","Navigate","auth","setPersistence","browserLocalPersistence","Navbar","PublicLanding","PrivateHome","BookList","BookDetails","AddBook","Profile","ChooseUsername","PrivateRoute","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AppWrapper","user","setUser","authChecked","setAuthChecked","location","unsubscribe","then","onAuthStateChanged","currentUser","emailVerified","catch","error","console","showNavbar","pathname","className","children","path","element","to","replace"],"sources":["/Users/julineeerdekens/Desktop/bookclub/src/components/AppWrapper.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Routes, Route, useLocation, Navigate } from \"react-router-dom\";\nimport { auth } from \"../firebase\";\nimport { setPersistence, browserLocalPersistence } from \"firebase/auth\";\n\nimport Navbar from \"./Navbar\";\nimport PublicLanding from \"../pages/PublicLanding\";\nimport PrivateHome from \"../pages/PrivateHome\";\nimport BookList from \"../pages/BookList\";\nimport BookDetails from \"../pages/BookDetails\";\nimport AddBook from \"../pages/AddBook\";\nimport Profile from \"../pages/Profile\";\nimport ChooseUsername from \"../pages/ChooseUsername\";\nimport PrivateRoute from \"./PrivateRoute\";\n\nfunction AppWrapper() {\n  const [user, setUser] = useState(null);\n\n  \n  const [authChecked, setAuthChecked] = useState(false);\n  const location = useLocation();\n\n  useEffect(() => {\n  let unsubscribe;\n\n  setPersistence(auth, browserLocalPersistence)\n    .then(() => {\nunsubscribe = auth.onAuthStateChanged((currentUser) => {\n  if (currentUser && currentUser.emailVerified) {\n    setUser(currentUser);\n  } else {\n    setUser(null);\n  }\n  setAuthChecked(true);\n});\n\n    })\n    .catch((error) => {\n      console.error(\"Failed to set persistence:\", error);\n      setAuthChecked(true);\n    });\n\n  return () => {\n    if (unsubscribe) unsubscribe();\n  };\n}, []);\n\n\n  const showNavbar = user && location.pathname !== \"/\";\n\n  if (!authChecked) {\n    return <div className=\"text-center mt-5\">Loading...</div>;\n  }\n\n  return (\n    <>\n      {showNavbar && <Navbar user={user} />}\n\n      <Routes>\n        {/* Redirect to /home if already logged in */}\n        <Route\n          path=\"/\"\n          element={user ? <Navigate to=\"/home\" replace /> : <PublicLanding />}\n        />\n        <Route path=\"/choose-username\" element={<ChooseUsername />} />\n\n        {/* Protected Routes */}\n        <Route\n          path=\"/home\"\n          element={\n            <PrivateRoute user={user}>\n              <PrivateHome />\n            </PrivateRoute>\n          }\n        />\n        <Route\n          path=\"/books\"\n          element={\n            <PrivateRoute user={user}>\n              <BookList />\n            </PrivateRoute>\n          }\n        />\n        <Route\n          path=\"/books/:id\"\n          element={\n            <PrivateRoute user={user}>\n              <BookDetails />\n            </PrivateRoute>\n          }\n        />\n        <Route\n          path=\"/add\"\n          element={\n            <PrivateRoute user={user}>\n              <AddBook />\n            </PrivateRoute>\n          }\n        />\n        <Route\n          path=\"/profile\"\n          element={\n            <PrivateRoute user={user}>\n              <Profile />\n            </PrivateRoute>\n          }\n        />\n      </Routes>\n    </>\n  );\n}\n\nexport default AppWrapper;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}